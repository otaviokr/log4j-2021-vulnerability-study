package com.otaviokr.log4j;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

/**
 * Hello world!
 *
 */
public class Log4JStudy {
    //static Logger log = Logger.getLogger(Log4JStudy.class.getName());
    static Logger log = LogManager.getLogger();
    public static void main( String[] args ) {
        // String harmlessVariable = "${env:HOME}";
        String harmlessVariable = "${java:version}";
        // String maliciousVariable = "${jndi:ldap://localhost}";

        System.out.println("This is a case of study of vulnerability CVE-2021-44228");
        System.out.println("We will log different entries to show how the logger works,");
        System.out.println(" but in the end we will demonstrate how malicious code can be executed");
        System.out.println();
        System.out.println("First example is a harmless message, because it has no lookup:");
        log.info("This is a harmless INFO message");

        System.out.println();
        System.out.println("Second example has a lookup, but we are just retrieving environment variables, so it is safe too");
        log.error("This is a harmless INFO message, with a variable resolved: {}", harmlessVariable);

        // System.out.println();
        // System.out.println("Now, what if we used the lookup to execute something malicious? Like creating a file...");
        // log.error("This is a harmless INFO message, with a variable resolved: {}", maliciousVariable );
    }
}
